.. _contributing:

============
Contributing
============

This section provides some instructions for those who want to contribute with
the development of Nodimo.

Development Environment
-----------------------

Git and GitHub
^^^^^^^^^^^^^^

Nodimo is available on `GitHub`_ and uses `Git`_ for source control.

To get the source code from GitHub run::

    git clone https://github.com/rodrigopcastro018/nodimo

Virtual Environment
^^^^^^^^^^^^^^^^^^^

Isolate you development environment by using virtual environments. In the repository
folder, execute::

    python -m venv .venv

Activate the virtual environment by running::

    .venv/scripts/activate

From the repository folder, install Nodimo in editable mode with::

    pip install -e .

Tests
-----

Currently, Nodimo tests are integrated with `GitHub Actions`_. The tests coverage
are published by `smokeshow`_.

Tests status: |Tests status|

Tests coverage: |Tests coverage|

To manually execute Nodimo tests, follow the instructions in the next subsection.

Manual testing
^^^^^^^^^^^^^^

To install Nodimo testing dependencies, run::

    pip install -e .[test]

Nodimo contains type hints that can be checked with `mypy`_ by running::

    mypy

Main functionalities can be tested with `pytest`_ by executing::

    pytest

The `nbval`_ plugin is responsible for testing the `ipynb` files, while the
`pytest-cov`_ plugin includes these files in the reports generated by `coverage`_.

.. note::
    Configurations for ``mypy`` and ``pytest`` can be found in the ``pyproject.toml`` file.

Testing multiple environments
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Nodimo can be tested for multiple versions of its dependencies and python.
Multiple python versions can be installed with `pyenv`_ (or `pyenv-win`_ for windows).
The package `tox`_ can be used for test automation.

.. note::
    During the development of Nodimo on Windows, it was also necessary the installation
    of `tox-pyenv-redux`_ to enable the discovery of the ``pyenv`` python environments
    by ``tox``.

.. note::
    The ``tox`` configuration found in the ``pyproject.toml`` file is set to be
    used by the corresponding integrated github workflow.

Documentation
-------------

Currently, the documentation is being automatically built and hosted by `Read the Docs`_.

Documentation status: |Documentation status|

To manually build the documentation, read the instructions in the following subsection.

Build documentation
^^^^^^^^^^^^^^^^^^^

The documentation is built with `Sphinx`_, using `Furo`_ as a theme. Tutorials 
made with `jupyter notebook`_ were added to the documentation using the extension
`nbsphinx`_, copy buttons for code are supported by `sphinx-copybutton`_, and docstrings
follow the `numpydoc`_ standard.

To work properly, ``nbsphinx`` requires the installation of `IPython`_ and `pandoc`_.
It's recommended to install the latter manually.

To install all these dependencies (except ``pandoc``), just execute::

    pip install -e .[docs]

From the `docs` folder, create the `html` files by running:

* on Windows::

    ./make.bat html

* on Linux or macOS::

    make html

Formatting
----------

Code formatting follows the style established by `black`_.


.. _GitHub: https://github.com/rodrigopcastro018/nodimo
.. _Git: https://git-scm.com/
.. _GitHub Actions: https://github.com/rodrigopcastro018/nodimo/actions
.. _smokeshow: https://github.com/samuelcolvin/smokeshow
.. _mypy: https://mypy-lang.org/
.. _pytest: https://docs.pytest.org/
.. _nbval: https://github.com/computationalmodelling/nbval
.. _pytest-cov: https://pytest-cov.readthedocs.io/
.. _coverage: https://coverage.readthedocs.io/
.. _pyenv: https://github.com/pyenv/pyenv
.. _pyenv-win: https://github.com/pyenv-win/pyenv-win
.. _tox: https://tox.wiki/
.. _tox-pyenv-redux: https://github.com/un-def/tox-pyenv-redux
.. _Sphinx: https://www.sphinx-doc.org/
.. _Furo: https://github.com/pradyunsg/furo
.. _jupyter notebook: https://github.com/jupyter/notebook
.. _nbsphinx: https://nbsphinx.readthedocs.io/
.. _sphinx-copybutton: https://sphinx-copybutton.readthedocs.io/
.. _numpydoc: https://numpydoc.readthedocs.io/
.. _IPython: https://github.com/ipython/ipython
.. _pandoc: https://pandoc.org/
.. _Read the Docs: https://readthedocs.org/
.. _black: https://black.readthedocs.io/
.. |Documentation status| image:: https://readthedocs.org/projects/nodimo/badge/?version=latest
    :target: https://nodimo.readthedocs.io/
    :alt: Documentation status
.. |Tests status| image:: https://img.shields.io/github/actions/workflow/status/rodrigopcastro018/nodimo/full_test.yml?branch=main&label=Tests
    :target: https://github.com/rodrigopcastro018/nodimo/actions/workflows/full_test.yml
    :alt: Tests status
.. |Tests coverage| image:: https://coverage-badge.samuelcolvin.workers.dev/rodrigopcastro018/nodimo.svg
    :target: https://coverage-badge.samuelcolvin.workers.dev/redirect/rodrigopcastro018/nodimo
    :alt: Tests coverage
